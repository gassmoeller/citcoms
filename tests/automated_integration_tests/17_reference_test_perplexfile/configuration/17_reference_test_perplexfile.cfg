# basic template model, to be modified for individual purpose

[CitcomS]
solver = full
steps = 2                 ; number of time steps
totalTime = 4.66487e-4              ; etwa 600 Ma

[CitcomS.job]
name = 17_reference_test_perplexfile

# section not used in this model ... use output of 0.5 Ma hard-coded
[CitcomS.controller]
outputTimeStep = 1e-9 ; Time between two outputs 3Ma
outputStartTime = 0 ; 320 Ma beginning of output
# outputStartTime = 5.831094e-4 ; 750 Ma for long models
monitoringFrequency = 200    ; how often outputs are created
checkpointFrequency = 80000

[CitcomS.solver]
datafile = 17_reference_test_perplexfile     ; prefix of output filenames
gruneisen = 0.0
rayleigh = 8.347e+08         ; 2340K DeltaT
surfaceT = 0.117
Q0 = 86.7
adiabaticT0 = 0.6893     ; Tadi[0] / ref_temp
#verbose = on
datadir = ../data

[CitcomS.solver.output]
output_optional = comp_nd, surf, botm, material, seismic, geoid
vtk_format = ascii
steps = 2
output_format = vtk

[CitcomS.solver.mesher]
nprocx = 1
nprocy = 1
nprocz = 1
nodex = 17
nodey = 17
nodez = 17
levels = 4
#theta_min = 1.29
#theta_max = 2.3
#fi_min = 0.0
#fi_max = 1.41
radius_inner = 0.55
radius_outer = 1
coor = 1

[CitcomS.solver.vsolver]
Solver = multigrid
mg_cycle = 1
down_heavy = 2
up_heavy = 2
vlowstep = 20
vhighstep = 2
max_mg_cycles = 50
remove_rigid_rotation = off
remove_angular_momentum = off
accuracy = 5e-03
piterations = 250

[CitcomS.solver.bc]
toptbcval=0.0
topvbc = 1
bottbc=1
bottbcval=1.0
#vertbc = 0

[CitcomS.solver.param]
file_vbcs = on
start_age = 1
vel_bound_file = 17-2/bvel.dat
reference_state = 4
refstate_file=refstate.dat

[CitcomS.solver.ic]
tic_method = 10 ; sub-adiabaticity will evolve out of model
half_space_age = 1
mantle_temp=0.573
blob_dT=0.0
#0% thermisch
blob_radius=[0.3,0.3,0.07]
perturbmag=0.01
perturbl = 3
perturbm = 2

[CitcomS.solver.tsolver]
fixed_timestep = 1.0e-7
filter_temp = off
finetunedt = 0.5

[CitcomS.solver.visc]
num_mat = 4
TDEPV = on
rheol = 104
CDEPV = off
cdepv_ff = 1,1
VMIN = on
visc_min = 0.015
VMAX = on
visc_max = 150

[CitcomS.solver.tracer]
tracer = on
tracer_ic_method = 0
deterministic_initial_tracer_positions = 1

tracers_per_element = 20
tracer_file = tracer.dat

tracer_flavors = 4
ic_method_for_flavors = 3
z_interface = [0.9992,0.574,0.4] ; according to Burke 2008 EPSL ~1 wt % of mantle here 130 km
initial_content = [1.0,1.0,1] ; percentage of material in layers

continents = 1
chemical_buoyancy = 1
#delta_temp = 20       ; needs to be present until revision 86
start_temp = 400      ; Lowest temperature with provided density
end_temp = 4000       ; Highest temperature
ntdeps = 181          ; Number of Temperature values (end-start/delta +1)
pressure_oversampling = 1
tracer_enriched = off
chemical_changes = 1 ; needs to be present after revision 86

buoy_type = 1
buoyancy_ratio = [0.0,0.0,0.0] ;[0.5402,0.2701]
# according to McNamara & Zhong 2005 ; Garnero and McNamara 2008; 2-5%
regular_grid_deltheta = 0.8
regular_grid_delphi = 0.8


[CitcomS.solver.const]
thermexp=4.21e-05
